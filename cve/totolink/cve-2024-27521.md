# Authenticated command injection on TOTOLINK A3300R router (CVE-2024-27521)

## Summary
The TOTOLINK A3300R device is affected by an authenticated command execution vulnerability, on multiple parameters used by the "setOpModeCfg" function.

## Affected products
- TOTOLINK A3300R (FW version V17.0.0cu.557\_B20221024)

Note that this issue may affect also other device models and firmware versions, but they were not checked.

## Details
This issue is an authenticated command injection vulnerability that enables an attacker who has access to the router web interface, either locally or remotely, to execute arbitrary commands on the underlying Linux system.

## PoC
Omitted.

## Impact
This security issue allows an attacker to take complete control of the device. In detail, exploitation allows authenticated attackers to execute arbitrary system commands with administrative privileges (i.e., as user "root"). This issue can be exploited remotely whenever the router web UI is exposed on the WAN side.

## Additional information

### Credit
Spike Reply Cybersecurity Team

### Acknowledgments

### References
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-27521

### Disclosure timeline ##

- August 26, 2023: Attempt to contact Totolink (no response)
- September 4, 2023: Vulnerability disclosure to CERT/CC (ID VU#654015)
- February 14, 2024: CERT/CC's attempt to contact the vendor failed (vendor did not reply)
- February 24, 2024: Vulnerability reported to MITRE
