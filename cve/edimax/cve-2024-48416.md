# Buffer overflow in fromSetLanDhcpsClientbinding (CVE-2024-48416) #

## Summary
The page `/goform/fromSetLanDhcpsClientbinding` does not implement boundary checks on one of its input parameters. Attackers can leverage this issue to trigger a buffer overflow condition, which can be easily exploited to cause denial of service or possibly execute arbitrary commands.

As a side note, since the device does not implement any anti-CSRF mechanism, present issue could be exploited remotely through CSRF techniques.

## Affected products
* Edimax dual band 5 Wi-Fi AC1200 BR-6476AC (firmware BR-6476AC\_1.06)

## Details
According to the device vendor, this product is now out of support and no security patches will be provided. For this reason, details on how to reproduce the vulnerability are deliberately omitted.

## PoC
When the malicious request are processed by the device web UI, a stack-based buffer overflow occurrs, as shown in the `strace` output below.
```
[2b36c2c4] close(16)					= 0
[2b36c7e8] time(NULL)					= 1423365822 (2015-02-08T03:23:42+0000)
[2b368704] access("/var/run/lan_wan_is_samenet", F_OK) = -1 ENOENT (No such file or directory)
[2b38fcb4] --- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x7fec1000} ---
[????????] +++ killed by SIGSEGV +++
```
## Impact
By exploiting this vulnerability it is possible to alter the normal behavior of the web server that hosts the management GUI of the router, and possibly achieve arbitrary code execution. Please note that, since the device does not implement any anti-CSRF mechanism, present issue could be exploited remotely through CSRF techniques.

## Additional information

### Credit
Spike Reply Cybersecurity Team

### Disclosure timeline
- July 18, 2024: Initial vendor contact
- August 9, 2024: Vulnerability acknowledged by device vendor, but no fix will be implemented as the device is out of support
- November 5, 2024: Disclosure
