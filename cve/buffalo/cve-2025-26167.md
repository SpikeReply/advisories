# Unauthenticated arbitrary file read in Buffalo LinkStation LS520D (CVE-2025-26167) #

## Summary
We discovered a vulnerability in the Buffalo LinkStation LS520D NAS that allows unauthenticated attackers to access the web UI and read internal files. This issue could potentially expose the system's internal passwords file, posing a risk of unauthorized remote access to the NAS.

## Affected products
* Buffalo LinkStation LS520D (firmware 4.53)

## Details

The root cause of this issue is an internal Python package, `webaxs_rpc.pyc`, which manages web UI requests. This file processes several RPC requests, including those for the path `/rpc/cat`. These requests are intended to retrieve internal files, but the file path must be properly sanitized first. The application logic is implemented in the following code snippet:


```
	...
	path = url[len(prefix):]
	if kw.get('inter', False):
		fullpath = os.path.join('/', path)
	else:
		fullpath, _ = _virpath2path(path, login, None, kw.get('axs_uuid'))
	try:
		sb = os.stat(fullpath)
	except os.error:
		raise StatusComplete(404, error_headers, 'No such file or directory')
	...
```

As shown in the code above, the `inter` parameter can be used to bypass the file path validation logic entirely, allowing access to arbitrary internal files.

## PoC
As a "proof-of-concept", the following web request returns the contents of local file `/etc/shadow`: http://192.168.1.100/rpc/cat/etc/shadow?inter=1

## Impact
By exploiting this vulnerability an attacker can ready arbitrary internal files, that may disclose sensitive data (e.g., web UI password hashes).

## Additional information

### Credit
Spike Reply Cybersecurity Team

### Disclosure timeline
- May 21, 2024: Initial vendor contact and disclosure of vulnerability details
- November 18, 2024: Vendor confirms a firmware update to address this issue is scheduled for January 2025
- January 20, 2025: Vendor releases a firmware version that should update this issue (version 4.54)
- March 3, 2025: Disclosure
